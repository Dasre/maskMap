{"version":3,"sources":["redux/actions.js","redux/actionTypes.js","components/Pharmacy.js","components/Sidebar.js","components/Map.js","App.js","redux/reducers/map.js","index.js"],"names":["getCoordinates","dispatch","getState","a","navigator","geolocation","getCurrentPosition","position","type","payload","lat","coords","latitude","lon","longitude","Cards","styled","Card","connect","state","nowData","Content","header","select","properties","name","List","bulleted","Item","phone","address","Label","horizontal","color","mask_adult","mask_child","note","extra","updated","SearchBox","Menu","NowPosition","div","Sidebar","props","changeState","event","setState","input","target","value","getPosition","getTargetPosition","vertical","style","height","width","Button","content","primary","onClick","this","Input","id","icon","onChange","length","Component","api","axios","get","then","res","data","Map","handleClick","lng","latlng","oneData","filter","da","geometry","coordinates","getNowSelectData","getMaskData","myIcon","L","iconUrl","shadowUrl","iconSize","iconAnchor","popupAnchor","shadowSize","redIcon","greenIcon","center","lists","map","dataInfo","Marker","key","Popup","htmlFor","circular","zoom","maxZoom","TileLayer","attribution","url","data-testid","PureComponent","features","App","Grid","padded","Row","Column","only","tablet","computer","mobile","initialState","composeEnhancer","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","action","applyMiddleware","thunk","ReactDOM","render","document","getElementById"],"mappings":"8WAcaA,EAAiB,yDAAM,WAAOC,EAAUC,GAAjB,SAAAC,EAAA,sEAC5BC,UAAUC,YAAYC,oBAAmB,SAACC,GAC9CN,EAAS,CACPO,KCjByB,kBDkBzBC,QAAS,CACPC,IAAKH,EAASI,OAAOC,SACrBC,IAAKN,EAASI,OAAOG,gBANO,2CAAN,yD,kKET9B,IAAMC,EAAQC,YAAOC,IAAPD,CAAH,KAkDIE,eAJS,SAACC,GAAD,MAAY,CAClCC,QAASD,EAAMC,WAKf,KAFaF,EA7CE,SAAC,GAAD,IAAGE,EAAH,EAAGA,QAAH,OACf,oCACE,kBAACL,EAAD,KACE,kBAACE,EAAA,EAAKI,QAAN,CAAcC,OAAQF,EAAQG,OAAO,GAAGC,WAAWC,OACnD,kBAACR,EAAA,EAAKI,QAAN,KACE,kBAACK,EAAA,EAAD,CAAMC,UAAQ,GACZ,kBAACD,EAAA,EAAKE,KAAN,0BAAeR,EAAQG,OAAO,GAAGC,WAAWK,OAC5C,kBAACH,EAAA,EAAKE,KAAN,0BAAeR,EAAQG,OAAO,GAAGC,WAAWM,SAC5C,kBAACJ,EAAA,EAAKE,KAAN,sCAEE,kBAACG,EAAA,EAAD,CACEC,YAAU,EACVC,MAAOb,EAAQG,OAAO,GAAGC,WAAWU,WAAa,IAAM,QAAU,OAEhEd,EAAQG,OAAO,GAAGC,WAAWU,aAGlC,kBAACR,EAAA,EAAKE,KAAN,sCAEE,kBAACG,EAAA,EAAD,CACEC,YAAU,EACVC,MAAOb,EAAQG,OAAO,GAAGC,WAAWW,WAAa,GAAK,QAAU,OAE/Df,EAAQG,OAAO,GAAGC,WAAWW,aAGlC,kBAACT,EAAA,EAAKE,KAAN,sCAEGR,EAAQG,OAAO,GAAGC,WAAWY,QAIpC,kBAACnB,EAAA,EAAKI,QAAN,CAAcgB,OAAK,GAAnB,+DAEGjB,EAAQG,OAAO,GAAGC,WAAWc,c,yMCnCtC,IAAMC,EAAYvB,YAAOwB,IAAKZ,KAAZZ,CAAH,KAITyB,EAAczB,IAAO0B,IAAV,KAKXC,E,YACJ,WAAYC,GAAQ,IAAD,8BACjB,4CAAMA,KAMRC,YAAc,SAACC,GACb,EAAKC,SAAS,CAACC,MAAMF,EAAMG,OAAOC,SARjB,EAWnBC,YAAc,WACZ,EAAKP,MAAMQ,kBAAkB,EAAKjC,MAAM6B,QAVxC,EAAK7B,MAAQ,CACX6B,MAAO,IAHQ,E,sEAiBjB,OACE,kBAACR,EAAA,EAAD,CAAMa,UAAQ,EAACC,MAAO,CAAEC,OAAQ,QAASC,MAAO,SAC9C,kBAACjB,EAAD,KACE,kBAACE,EAAD,sCAEE,kBAACgB,EAAA,EAAD,CACEC,QAAQ,uCACRC,SAAO,EACPC,QAASC,KAAKjB,MAAM5C,kBAGxB,6BACE,kBAAC8D,EAAA,EAAD,CACEC,GAAG,SACHC,KAAK,SACLd,MAAOW,KAAK1C,MAAM6B,MAClBiB,SAAUJ,KAAKhB,cAEjB,kBAACY,EAAA,EAAD,CAAQC,QAAQ,eAAKC,SAAO,EAACC,QAASC,KAAKV,cAC3C,uIAK2B,IAA9BU,KAAKjB,MAAMxB,QAAQ8C,OAAe,kBAAC,EAAD,MAAe,U,GA1CpCC,aAoDPjD,eAJS,SAACC,GAAD,MAAY,CAClCC,QAASD,EAAMC,WAKf,CAAEgC,kBH9C6B,SAACJ,GAAD,OAAW,SAAC/C,EAAUC,GACrD,IAAMkE,EAAG,iDAA6CpB,EAA7C,wBACTqB,IAAMC,IAAIF,GACTG,MAAK,SAACC,GACLvE,EAAS,CACPO,KC7B4B,qBD8B5BC,QAAQ,CACNC,IAAK8D,EAAIC,KAAK,GAAG/D,IACjBG,IAAK2D,EAAIC,KAAK,GAAG5D,YGsCFb,kBAFRkB,CAGbyB,G,sEC/DI+B,E,2MAOJC,YAAc,SAAC7B,GAAW,IAChB8B,EAAQ9B,EAAM+B,OAAdD,IAEFE,EADW,EAAKlC,MAAd6B,KACaM,QAAO,SAAAC,GAAE,OAAIA,EAAGC,SAASC,YAAY,KAAON,KACjE,EAAKhC,MAAMuC,iBAAiBL,I,mFAR5BjB,KAAKjB,MAAMwC,cACXvB,KAAKjB,MAAM5C,mB,+BAUH,IAAD,OACDqF,EAASC,IAAEtB,KAAK,CACpBuB,QAAS,4FACTC,UAAW,gFACXC,SAAU,CAAC,GAAI,IACfC,WAAY,CAAC,GAAI,IACjBC,YAAa,CAAC,GAAI,IAClBC,WAAY,CAAC,GAAI,MAGbC,EAAUP,IAAEtB,KAAK,CACrBuB,QAAS,yFACTC,UAAW,gFACXC,SAAU,CAAC,GAAI,IACfC,WAAY,CAAC,GAAI,IACjBC,YAAa,CAAC,GAAI,IAClBC,WAAY,CAAC,GAAI,MAGbE,EAAYR,IAAEtB,KAAK,CACvBuB,QAAS,2FACTC,UAAW,gFACXC,SAAU,CAAC,GAAI,IACfC,WAAY,CAAC,GAAI,IACjBC,YAAa,CAAC,GAAI,IAClBC,WAAY,CAAC,GAAI,MAzBZ,EA4BkB/B,KAAKjB,MAAtBmD,EA5BD,EA4BCA,OAEJC,EA9BG,EA4BSvB,KAECwB,KAAI,SAACC,GAAD,OACnB,kBAACC,EAAA,EAAD,CACEC,IAAKF,EAAS1E,WAAWuC,GACzBxD,SAAU,CAAC2F,EAASjB,SAASC,YAAY,GAAIgB,EAASjB,SAASC,YAAY,IAC3ElB,KAAMkC,EAAS1E,WAAWU,WAAa,KAAOgE,EAAS1E,WAAWW,WAAa,GAAK0D,EAAUC,EAC9FlC,QAAS,EAAKe,aAEd,kBAAC0B,EAAA,EAAD,KACE,4BAAKH,EAAS1E,WAAWC,MACzB,6BAFF,qBAIE,2BAAIyE,EAAS1E,WAAWK,OACxB,6BACA,2BAAOyE,QAAQ,SAAf,iCAEE,kBAACvE,EAAA,EAAD,CACEwE,UAAQ,EACRtE,MAAOiE,EAAS1E,WAAWU,WAAa,IAAM,QAAU,OAEvDgE,EAAS1E,WAAWU,aAGzB,6BACA,2BAAOoE,QAAQ,SAAf,iCAEE,kBAACvE,EAAA,EAAD,CACEwE,UAAQ,EACRtE,MAAOiE,EAAS1E,WAAWW,WAAa,GAAK,QAAU,OAEtD+D,EAAS1E,WAAWW,kBAO/B,OACE,oCACE,kBAAC,IAAD,CAAM4D,OAAQA,EAAQS,KAAM,GAAIC,QAAS,GAAInD,MAAO,CAAEE,MAAO,OAAQD,OAAQ,SAC3E,kBAACmD,EAAA,EAAD,CACEC,YAAY,0EACZC,IAAI,6CAGN,kBAAC,IAAD,KACGZ,GAEH,kBAACG,EAAA,EAAD,CAAQ5F,SAAUwF,EAAQ/B,KAAMqB,GAC9B,kBAACgB,EAAA,EAAD,CAAOQ,cAAY,eAAnB,iE,GA5FMC,iBA4GH5F,eANS,SAACC,GAAD,MAAY,CAClC4E,OAAQ5E,EAAM4E,OACdS,KAAMrF,EAAMqF,KACZ/B,KAAMtD,EAAMsD,QAKZ,CAAEW,YJrHuB,kBAAM,SAACnF,EAAUC,GAC1CmE,IAAMC,IAAI,8EACPC,MAAK,SAACC,GACL,IAAMhD,EAAagD,EAAIC,KAAKsC,SAC5B9G,EAAS,CACPO,KCPoB,eDQpBC,QAASe,SI+GAxB,iBAAgBmF,iBJhFD,SAAC5D,GAAD,MAAa,CAC3Cf,KCtC+B,oBDuC/BC,QAAS,CACPc,aI2EWL,CAGbwD,G,OCpGasC,MAff,WACE,OACE,kBAACC,EAAA,EAAD,CAAMC,QAAM,GACV,kBAACD,EAAA,EAAKE,IAAN,KACE,kBAACF,EAAA,EAAKG,OAAN,CAAaC,KAAK,kBAAkBC,OAAQ,EAAGC,SAAU,GACvD,kBAAC,EAAD,OAEF,kBAACN,EAAA,EAAKG,OAAN,CAAaI,OAAQ,GAAIF,OAAQ,EAAGC,SAAU,GAAIjE,MAAO,CAAEC,OAAQ,QAASC,MAAO,SACjF,kBAAC,EAAD,U,QCZJiE,EAAe,CACnB1B,OAAQ,CAAC,UAAW,YACpBS,KAAM,GACN/B,KAAM,GACNrD,QAAS,ICGLsG,G,OAAkBC,OAAOC,sCAAwCC,KAEjEC,EAAQC,aDFC,WAAyC,IAA/B5G,EAA8B,uDAAtBsG,EAAcO,EAAQ,uCACrD,OAAQA,EAAOxH,MACb,ILVwB,eKWtB,IAAMgB,EAAawG,EAAOvH,QAC1B,OAAO,eACFU,EADL,CAEEsD,KAAMjD,IAGV,ILlB2B,kBKkBJ,IAAD,EACCwG,EAAOvH,QAApBC,EADY,EACZA,IAAKG,EADO,EACPA,IACb,OAAO,eACFM,EADL,CAEE4E,OAAQ,CAACrF,EAAKG,KAGlB,ILvB8B,qBKuBJ,IAAD,EACFmH,EAAOvH,QAApBC,EADe,EACfA,IAAKG,EADU,EACVA,IACb,OAAO,eACFM,EADL,CAEE4E,OAAQ,CAACrF,EAAKG,KAGlB,IL7B6B,oBK8B3B,IAAMU,EAASyG,EAAOvH,QACtB,OAAO,eACFU,EADL,CAEEC,QAASG,IAGb,QACE,OAAOJ,KC3BXuG,EAAgBO,YAAgBC,OAGlCC,IAASC,OACP,kBAAC,IAAD,CAAUN,MAAOA,GACf,kBAAC,EAAD,OAEFO,SAASC,eAAe,W","file":"static/js/main.5d2162e3.chunk.js","sourcesContent":["import axios from 'axios';\nimport { GET_COORDINATES, GET_MASKDATA, GET_TARGETPOSITION, GET_NOWSELECTDATA } from './actionTypes';\n\nexport const getMaskData = () => (dispatch, getState) => {\n  axios.get('https://raw.githubusercontent.com/kiang/pharmacies/master/json/points.json')\n    .then((res) => {\n      const properties = res.data.features;\n      dispatch({\n        type: GET_MASKDATA,\n        payload: properties,\n      });\n    });\n};\n\nexport const getCoordinates = () => async (dispatch, getState) => {\n  await navigator.geolocation.getCurrentPosition((position) => {\n    dispatch({\n      type: GET_COORDINATES,\n      payload: {\n        lat: position.coords.latitude,\n        lon: position.coords.longitude,\n      },\n    });\n  });\n};\n\nexport const getTargetPosition = (input) => (dispatch, getState) => {\n  const api = `https://nominatim.openstreetmap.org/?q=${input}&format=json&limit=1`;\n  axios.get(api)\n  .then((res) => {\n    dispatch({\n      type: GET_TARGETPOSITION,\n      payload:{\n        lat: res.data[0].lat,\n        lon: res.data[0].lon,\n      },\n    });\n  })\n};\n\nexport const getNowSelectData = (select) => ({\n  type: GET_NOWSELECTDATA,\n  payload: {\n    select\n  }\n})\n","export const GET_COORDINATES = 'GET_COORDINATES';\nexport const GET_MASKDATA = 'GET_MASKDATA';\nexport const GET_TARGETPOSITION = 'GET_TARGETPOSITION';\nexport const GET_NOWSELECTDATA = 'GET_NOWSELECTDATA';\n","import React from 'react';\nimport { Card, List, Label } from 'semantic-ui-react';\nimport { connect } from 'react-redux';\nimport styled from 'styled-components';\n\nconst Cards = styled(Card)`\n  margin-left: 1em !important;\n  margin-right: 1em !important;\n`;\n\nconst Pharmacy = ({ nowData }) => (\n  <>\n    <Cards>\n      <Card.Content header={nowData.select[0].properties.name} />\n      <Card.Content>\n        <List bulleted>\n          <List.Item>電話：{nowData.select[0].properties.phone}</List.Item>\n          <List.Item>地址：{nowData.select[0].properties.address}</List.Item>\n          <List.Item>\n            成人口罩：\n            <Label\n              horizontal\n              color={nowData.select[0].properties.mask_adult > 100 ? 'green' : 'red'}\n            >\n              {nowData.select[0].properties.mask_adult}\n            </Label>\n          </List.Item>\n          <List.Item>\n            兒童口罩：\n            <Label\n              horizontal\n              color={nowData.select[0].properties.mask_child > 50 ? 'green' : 'red'}\n            >\n              {nowData.select[0].properties.mask_child}\n            </Label>\n          </List.Item>\n          <List.Item>\n            營業時間：\n            {nowData.select[0].properties.note}\n          </List.Item>\n        </List>\n      </Card.Content>\n      <Card.Content extra>\n        此資料最後更新時間：\n        {nowData.select[0].properties.updated}\n      </Card.Content>\n    </Cards>\n  </>\n)\n\n\nconst mapStateToProps = (state) => ({\n  nowData: state.nowData,\n});\n\nexport default connect(\n  mapStateToProps,\n  null,\n)(Pharmacy);\n","import React, { Component } from 'react';\nimport {\n  Input, Menu, Button,\n} from 'semantic-ui-react';\nimport styled from 'styled-components';\nimport { getTargetPosition, getCoordinates } from '../redux/actions'\nimport { connect } from 'react-redux';\nimport Pharmacy from './Pharmacy';\n\nconst SearchBox = styled(Menu.Item)`\n  background: #EFF8FF !important;\n`;\n\nconst NowPosition = styled.div`\n  margin-bottom: 10px;\n`;\n\n\nclass Sidebar extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      input: \"\",\n    };\n  }\n\n  changeState = (event) => {\n    this.setState({input:event.target.value})\n  }\n\n  getPosition = () => {\n    this.props.getTargetPosition(this.state.input);\n  }\n\n  render() {\n\n    return (\n      <Menu vertical style={{ height: '100vh', width: '100%' }}>\n        <SearchBox>\n          <NowPosition>\n            目前位置：\n            <Button\n              content=\"取得目前位置\" \n              primary \n              onClick={this.props.getCoordinates}\n            />\n          </NowPosition>\n          <div>\n            <Input \n              id=\"search\" \n              icon=\"search\"\n              value={this.state.input} \n              onChange={this.changeState}\n            />\n            <Button content=\"搜尋\" primary onClick={this.getPosition} />\n            <p>搜尋所在縣市、地址、周招店家名稱等</p>\n          </div>\n          \n          \n        </SearchBox>\n        {this.props.nowData.length !== 0 ? <Pharmacy /> : null}\n      </Menu>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => ({\n  nowData: state.nowData,\n});\n\nexport default connect(\n  mapStateToProps,\n  { getTargetPosition, getCoordinates },\n)(Sidebar);","import React, { PureComponent } from 'react';\nimport L from 'leaflet';\nimport {\n  Map as Maps, TileLayer, Marker, Popup,\n} from 'react-leaflet';\nimport MarkerClusterGroup from 'react-leaflet-markercluster';\nimport { Label } from 'semantic-ui-react';\nimport { connect } from 'react-redux';\nimport { getMaskData, getCoordinates, getNowSelectData } from '../redux/actions';\n\nclass Map extends PureComponent {\n\n  componentDidMount() {\n    this.props.getMaskData();\n    this.props.getCoordinates();\n  }\n\n  handleClick = (event) => {\n    const { lng } = event.latlng;\n    const { data } = this.props;\n    const oneData = data.filter(da => da.geometry.coordinates[0] === lng);\n    this.props.getNowSelectData(oneData);\n  }\n\n  render() {\n    const myIcon = L.icon({\n      iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-violet.png',\n      shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',\n      iconSize: [25, 41],\n      iconAnchor: [12, 41],\n      popupAnchor: [1, -34],\n      shadowSize: [41, 41],\n    });\n\n    const redIcon = L.icon({\n      iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png',\n      shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',\n      iconSize: [25, 41],\n      iconAnchor: [12, 41],\n      popupAnchor: [1, -34],\n      shadowSize: [41, 41],\n    });\n\n    const greenIcon = L.icon({\n      iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png',\n      shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',\n      iconSize: [25, 41],\n      iconAnchor: [12, 41],\n      popupAnchor: [1, -34],\n      shadowSize: [41, 41],\n    });\n\n    const { center, data } = this.props;\n\n    let lists = data.map((dataInfo) => (\n      <Marker\n        key={dataInfo.properties.id}\n        position={[dataInfo.geometry.coordinates[1], dataInfo.geometry.coordinates[0]]}\n        icon={dataInfo.properties.mask_adult < 100 || dataInfo.properties.mask_child < 50 ? redIcon : greenIcon}\n        onClick={this.handleClick}\n      >\n        <Popup>\n          <h2>{dataInfo.properties.name}</h2>\n          <br />\n          電話：\n          <b>{dataInfo.properties.phone}</b>\n          <br />\n          <label htmlFor=\"adult\">\n            成人口罩：\n            <Label\n              circular\n              color={dataInfo.properties.mask_adult > 100 ? 'green' : 'red'}\n            >\n              {dataInfo.properties.mask_adult}\n            </Label>\n          </label>\n          <br />\n          <label htmlFor=\"child\">\n            兒童口罩：\n            <Label\n              circular\n              color={dataInfo.properties.mask_child > 25 ? 'green' : 'red'}\n            >\n              {dataInfo.properties.mask_child}\n            </Label>\n          </label>\n        </Popup>\n      </Marker>\n    ))\n\n    return (\n      <>\n        <Maps center={center} zoom={16} maxZoom={18} style={{ width: '100%', height: '100%' }}>\n          <TileLayer\n            attribution='&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n            url=\"https://{s}.tile.osm.org/{z}/{x}/{y}.png\"\n          />\n\n          <MarkerClusterGroup>\n            {lists}\n          </MarkerClusterGroup>\n          <Marker position={center} icon={myIcon}>\n            <Popup data-testid=\"nowPosition\">\n              你的所在位置！！！\n            </Popup>\n          </Marker>\n        </Maps>\n      </>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => ({\n  center: state.center,\n  zoom: state.zoom,\n  data: state.data,\n});\n\nexport default connect(\n  mapStateToProps,\n  { getMaskData, getCoordinates, getNowSelectData },\n)(Map);\n","import React from 'react';\nimport { Grid } from 'semantic-ui-react';\nimport Sidebar from './components/Sidebar';\nimport Map from './components/Map';\nimport './stylesheets/app.scss';\n\nfunction App() {\n  return (\n    <Grid padded>\n      <Grid.Row>\n        <Grid.Column only='tablet computer' tablet={4} computer={4}>\n          <Sidebar />\n        </Grid.Column>\n        <Grid.Column mobile={16} tablet={4} computer={12} style={{ height: '100vh', width: '100%' }}>\n          <Map />\n        </Grid.Column>\n      </Grid.Row>\n    </Grid>\n  );\n}\n\nexport default App;\n","import { GET_COORDINATES, GET_MASKDATA, GET_TARGETPOSITION, GET_NOWSELECTDATA } from '../actionTypes';\n\nconst initialState = {\n  center: [25.033671, 121.564427],\n  zoom: 16,\n  data: [],\n  nowData: [],\n};\n\nexport default function (state = initialState, action) {\n  switch (action.type) {\n    case GET_MASKDATA: {\n      const properties = action.payload;\n      return {\n        ...state,\n        data: properties,\n      };\n    }\n    case GET_COORDINATES: {\n      const { lat, lon } = action.payload;\n      return {\n        ...state,\n        center: [lat, lon],\n      };\n    }\n    case GET_TARGETPOSITION: {\n      const { lat, lon } = action.payload;\n      return {\n        ...state,\n        center: [lat, lon]\n      }\n    }\n    case GET_NOWSELECTDATA: {\n      const select = action.payload;\n      return {\n        ...state,\n        nowData: select,\n      }\n    }\n    default:\n      return state;\n  }\n}\n\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport thunk from 'redux-thunk';\nimport { createStore, applyMiddleware, compose } from 'redux';\nimport App from './App';\nimport reducers from './redux/reducers/map';\nimport 'semantic-ui-css/semantic.min.css';\n\nconst composeEnhancer = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nconst store = createStore(\n  reducers,\n  composeEnhancer(applyMiddleware(thunk)),\n);\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}